# Test: World Management Commands
# Category: Server Commands
# Purpose: Tests time and weather management commands

name: "World Management Test"
description: |
  Tests world management commands including time of day,
  weather control, and world environment settings.

backend: mineflayer

setup:
  - action: "connect"
    player: "pilaf_tester"
    name: "Connect test player"

  - action: "wait"
    duration: 5
    name: "Wait for connection"

  - action: "servercommand"
    command: "say [Pilaf] Starting world management test..."
    name: "Announce test start"

  - action: "servercommand"
    command: "gamemode creative pilaf_tester"
    name: "Set player to creative mode"

steps:
  # Test 1: Set time to dawn
  - action: "servercommand"
    command: "time set dawn"
    name: "Set time to dawn"

  - action: "get_world_time"
    name: "Get time after dawn"
    storeAs: "time_dawn"

  - action: "wait"
    duration: 2
    name: "Wait for change"

  # Test 2: Set time to night
  - action: "servercommand"
    command: "time set night"
    name: "Set time to night"

  - action: "get_world_time"
    name: "Get time after night"
    storeAs: "time_night"

  - action: "wait"
    duration: 2
    name: "Wait for change"

  # Test 3: Set clear weather
  - action: "servercommand"
    command: "weather clear 600"
    name: "Set clear weather for 10 minutes"

  - action: "get_weather"
    name: "Get weather status"
    storeAs: "weather_clear"

  - action: "wait"
    duration: 2
    name: "Wait for weather change"

  # Test 4: Set rain weather
  - action: "servercommand"
    command: "weather rain 300"
    name: "Set rain weather for 5 minutes"

  - action: "get_weather"
    name: "Get weather during rain"
    storeAs: "weather_rain"

  - action: "wait"
    duration: 2
    name: "Wait for weather change"

  # Test 5: Set thunder weather
  - action: "servercommand"
    command: "weather thunder 120"
    name: "Set thunder weather for 2 minutes"

  - action: "get_weather"
    name: "Get weather during thunder"
    storeAs: "weather_thunder"

  - action: "wait"
    duration: 2
    name: "Wait for weather change"

  # Test 6: Restore clear weather
  - action: "servercommand"
    command: "weather clear 600"
    name: "Restore clear weather"

cleanup:
  - action: "servercommand"
    command: "time set noon"
    name: "Reset time to noon"

  - action: "servercommand"
    command: "weather clear 600"
    name: "Reset weather to clear"

  - action: "servercommand"
    command: "say [Pilaf] World management test completed"
    name: "Announce completion"

  - action: "disconnect"
    player: "pilaf_tester"
    name: "Disconnect test player"
