---
layout: default
title: Server Commands Reference
nav_order: 1
description: "Reference for primitive server commands in Pilaf"
parent: Command Reference
permalink: /reference/server-commands/
---

== Server Commands Reference

[.lead]
Primitive server commands are RCON-based operations that cannot be accomplished using normal Minecraft server commands. Most server operations should use `SERVER_COMMAND` or `EXECUTE_RCON_COMMAND` with standard Minecraft syntax.

== Overview

Pilaf provides primitive server commands for framework-level operations. For all other server operations, use `SERVER_COMMAND` with standard Minecraft command syntax.

[NOTE]
====
**Primitive vs. Composite Commands**

*Primitive commands* are framework-level operations that cannot be done with Minecraft commands:
- Service health checks
- State capture and management
- Framework-specific testing operations

*Composite commands* should use `SERVER_COMMAND` with Minecraft syntax:
- `/summon` instead of `SPAWN_ENTITY`
- `/kill` instead of `KILL_ENTITY`
- `/op` instead of `MAKE_OPERATOR`
- `/time` instead of `GET_WORLD_TIME`/`SET_TIME`
- `/weather` instead of `GET_WEATHER`/`SET_WEATHER`
====

=== Command Categories

* *Framework Commands*: Service health, state management
* *RCON Execution*: Generic command execution with Minecraft syntax

'''

[[server_command]]
=== SERVER_COMMAND

[.lead]
Execute any Minecraft server command via RCON. This is the primary primitive for all server-side operations.

==== Syntax

[source,yaml]
----
- action: "SERVER_COMMAND"
  id: "unique_step_id"              # <1>
  name: "Human-readable name"       # <2>
  command: "minecraft_command"      # <3>
----

<1> Step ID for output referencing (optional)
<2> Descriptive name for logging and reports (optional)
<3> The complete Minecraft command to execute

==== Parameters

[cols="1,1,2,3"]
|===
|Parameter |Type |Required |Description

|`action`
|string
|Yes
|Must be `"SERVER_COMMAND"`

|`id`
|string
|No
|Step identifier for referencing outputs

|`name`
|string
|No
|Human-readable description of the action

|`command`
|string
|Yes
|Complete Minecraft command (e.g., `"op pilaf_tester"`)
|===

==== Outputs

[cols="1,2,3"]
|===
|Output |Type |Description

|`result`
|string
|Full command response from the server

|`status`
|string
|`"success"` if command executed, `"failure"` if error occurred

|`message`
|string
|Human-readable status message
|===

==== Examples

.Spawn an entity
[source,yaml]
----
- action: "SERVER_COMMAND"
  name: "Spawn zombie"
  command: "summon zombie ~ ~ ~ {CustomName:'\"test_zombie\"'}"
----

.Grant operator status
[source,yaml]
----
- action: "SERVER_COMMAND"
  name: "Grant operator"
  command: "op pilaf_tester"
----

.Set world time
[source,yaml]
----
- action: "SERVER_COMMAND"
  name: "Set to noon"
  command: "time set noon"
----

.Kill entities
[source,yaml]
----
- action: "SERVER_COMMAND"
  name: "Kill all zombies"
  command: "kill @e[type=zombie]"
----

.Set weather
[source,yaml]
----
- action: "SERVER_COMMAND"
  name: "Clear weather"
  command: "weather clear"
----

.Clear inventory
[source,yaml]
----
- action: "SERVER_COMMAND"
  name: "Clear inventory"
  command: "clear pilaf_tester"
----

.Get server version
[source,yaml]
----
- action: "SERVER_COMMAND"
  name: "Get version"
  command: "version"
----

==== Common Minecraft Commands

Use `SERVER_COMMAND` with these standard Minecraft commands:

[cols="2,3"]
|===
|Minecraft Command |Purpose

|`op <player>`
|Grant operator status

|`deop <player>`
|Remove operator status

|`summon <entity> [pos]`
|Spawn entity at position

|`kill [target]`
|Kill entities or player

|`time set <time>`
|Set world time (day, noon, night, midnight, or ticks)

|`time query`
|Query current world time

|`weather <clear|rain|thunder>`
|Set weather

|`gamemode <mode> [player]`
|Change game mode

|`give <player> <item> [count]`
|Give items to player

|`clear [player]`
|Clear player inventory

|`teleport <target> <destination>`
|Teleport entity

|`data get entity <entity>`
|Get entity NBT data

|`effect give <player> <effect>`
|Give status effect
|===

==== Related Commands

* link:player-commands.html#player_command[PLAYER_COMMAND] - Execute as player
* link:workflow-assertion-commands.html#check_service_health[CHECK_SERVICE_HEALTH] - Check backend health
* link:workflow-assertion-commands.html#store_state[STORE_STATE] - Capture command output

'''

[[check_service_health]]
=== CHECK_SERVICE_HEALTH

[.lead]
Check if a service (Minecraft server, Mineflayer bridge, or RCON) is healthy and responsive. This is a framework-level primitive for verifying service availability before executing commands.

==== Syntax

[source,yaml]
----
- action: "CHECK_SERVICE_HEALTH"
  id: "unique_step_id"              # <1>
  name: "Human-readable name"       # <2>
  service: "minecraft"              # <3>
----

<1> Step ID for output referencing (optional)
<2> Descriptive name (optional)
<3> Service type: `minecraft`, `mineflayer`, `rcon` (default: minecraft)

==== Parameters

[cols="1,1,2,3"]
|===
|Parameter |Type |Required |Description

|`action`
|string
|Yes
|Must be `"CHECK_SERVICE_HEALTH"`

|`id`
|string
|No
|Step identifier

|`name`
|string
|No
|Human-readable description

|`service`
|string
|No
|Service type: `minecraft` (default), `mineflayer`, `rcon`
|===

==== Outputs

[cols="1,2,3"]
|===
|Output |Type |Description

|`result`
|json
|JSON object with health status details

|`healthy`
|boolean
|`true` if service is healthy

|`status`
|string
|`"healthy"`, `"unhealthy"`, or `"unknown"`

|`message`
|string
|Human-readable status message

|`latency`
|number
|Response time in milliseconds
|===

==== Example

[source,yaml]
----
# Check Minecraft server health
- action: "CHECK_SERVICE_HEALTH"
  id: "server_health"
  name: "Check server health"

# Verify server is ready
- action: "ASSERT_RESPONSE_CONTAINS"
  name: "Verify server healthy"
  source: "${{ steps.server_health.outputs.healthy }}"
  contains: "true"

# Check RCON connectivity
- action: "CHECK_SERVICE_HEALTH"
  id: "rcon_health"
  name: "Check RCON health"
  service: "rcon"

# Check Mineflayer bridge
- action: "CHECK_SERVICE_HEALTH"
  id: "bridge_health"
  name: "Check Mineflayer bridge"
  service: "mineflayer"
----

==== Related Commands

* link:workflow-assertion-commands.html#wait[WAIT] - Wait for service to become available
* link:player-commands.html#connect_player[CONNECT_PLAYER] - Connect player after health check

'''

== Command Summary

[cols="2,3,2"]
|===
|Command |Purpose |Key Outputs

|link:#server_command[SERVER_COMMAND]
|Execute any Minecraft command via RCON
|`result`, `status`, `message`

|link:#check_service_health[CHECK_SERVICE_HEALTH]
|Verify service availability
|`healthy`, `latency`, `status`
|===

'''

== See Also

* link:player-commands.html[Player Commands] - Mineflayer client actions
* link:workflow-assertion-commands.html[Workflow & Assertion Commands] - Control flow and validation
* link:guides/writing-stories.html[Writing Stories] - How to use commands in stories
