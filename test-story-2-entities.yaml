# Entity Operations Test
# Tests entity spawning and health management across backends
name: "Entity Operations Test"
description: "Tests entity spawning and health management across backends"

setup:
  - action: "SERVER_COMMAND"
    command: "say Starting entity operations test"
    name: "Server announcement"

  - action: "SERVER_COMMAND"
    command: "gamemode creative TestPlayer"
    name: "Set player to creative mode"

steps:
  # Spawn a test cow using SERVER_COMMAND with summon
  - action: "SERVER_COMMAND"
    command: "summon cow ~ ~ ~ {CustomName:\"TestCow\"}"
    name: "Spawn test cow"

  - action: "WAIT"
    duration: 2000
    name: "Wait for spawn"

  # Check entity exists
  - action: "ASSERT_ENTITY_EXISTS"
    entity: "TestCow"
    name: "Verify cow exists"

  # Entity health can be checked using data command
  - action: "SERVER_COMMAND"
    id: "cow_health"
    command: "data get entity @e[type=cow,custom_name=TestCow,limit=1] Health"
    name: "Get cow health"

  # Spawn multiple entities using summon
  - action: "SERVER_COMMAND"
    command: "summon zombie ~5 ~ ~5 {CustomName:\"TestZombie\"}"
    name: "Spawn test zombie"

  - action: "WAIT"
    duration: 2000
    name: "Wait for spawn"

  - action: "SERVER_COMMAND"
    command: "summon creeper ~10 ~ ~10 {CustomName:\"TestCreeper\"}"
    name: "Spawn test creeper"

  - action: "WAIT"
    duration: 2000
    name: "Wait for spawn"

  # Verify entities exist
  - action: "ASSERT_ENTITY_EXISTS"
    entity: "TestZombie"
    name: "Verify zombie exists"

  - action: "ASSERT_ENTITY_EXISTS"
    entity: "TestCreeper"
    name: "Verify creeper exists"

cleanup:
  # Clean up entities using kill command
  - action: "SERVER_COMMAND"
    command: "kill @e[custom_name=TestCow]"
    name: "Remove test cow"

  - action: "SERVER_COMMAND"
    command: "kill @e[custom_name=TestZombie]"
    name: "Remove test zombie"

  - action: "SERVER_COMMAND"
    command: "kill @e[custom_name=TestCreeper]"
    name: "Remove test creeper"

  - action: "SERVER_COMMAND"
    command: "say Entity operations test completed"
    name: "Test completion announcement"
